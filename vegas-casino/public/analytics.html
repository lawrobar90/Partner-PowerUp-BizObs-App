<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casino Analytics - Dynatrace Vegas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { background: linear-gradient(135deg, #0A0A0A 0%, #151515 100%); }
        .metric-card { background: #151515cc; border: 1px solid #00D4FF33; }
        .chart-container { background: #151515cc; border: 1px solid #6C2C9C33; }
    </style>
</head>
<body class="min-h-screen text-white font-sans">
    <header class="bg-black/80 px-6 py-4 flex items-center justify-between">
        <button onclick="window.location.href='lobby.html'" class="bg-gradient-to-r from-cyan-500 to-purple-600 text-white px-4 py-2 rounded-lg font-semibold">Back to Lobby</button>
        <h1 class="text-2xl font-bold bg-gradient-to-r from-cyan-400 via-purple-500 to-green-400 bg-clip-text text-transparent">Casino Analytics</h1>
        <span class="text-sm text-cyan-300">Live Data</span>
    </header>
    <main class="max-w-7xl mx-auto px-6 py-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="metric-card rounded-xl p-6"><div class="text-sm text-gray-400">Total Players</div><div class="text-2xl font-bold text-cyan-400" id="totalPlayers">0</div></div>
            <div class="metric-card rounded-xl p-6"><div class="text-sm text-gray-400">Total Bets</div><div class="text-2xl font-bold text-yellow-400" id="totalBets">$0</div></div>
            <div class="metric-card rounded-xl p-6"><div class="text-sm text-gray-400">House Edge</div><div class="text-2xl font-bold text-purple-400" id="houseEdge">0%</div></div>
            <div class="metric-card rounded-xl p-6"><div class="text-sm text-gray-400">Active Games</div><div class="text-2xl font-bold text-green-400" id="activeGames">0</div></div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <div class="chart-container rounded-xl p-6"><h3 class="text-lg font-semibold text-cyan-400 mb-4">Game Activity</h3><canvas id="gameActivityChart" width="400" height="200"></canvas></div>
            <div class="chart-container rounded-xl p-6"><h3 class="text-lg font-semibold text-yellow-400 mb-4">Revenue by Game</h3><canvas id="revenueChart" width="400" height="200"></canvas></div>
        </div>
    </main>
    <script>
        const socket = io();
        let analyticsData = { totalPlayers: 0, totalBets: 0, houseEdge: 5.2, activeGames: 0, revenue: {} };
        let gameActivityChart, revenueChart;
        document.addEventListener('DOMContentLoaded', () => {
            const gameActivityCtx = document.getElementById('gameActivityChart').getContext('2d');
            gameActivityChart = new Chart(gameActivityCtx, {
                type: 'line',
                data: { labels: [], datasets: [{ label: 'Active Games', data: [], borderColor: '#00D4FF', backgroundColor: 'rgba(0,212,255,0.1)', tension: 0.4, fill: true }] },
                options: { responsive: true, plugins: { legend: { labels: { color: '#fff' } } }, scales: { x: { ticks: { color: '#aaa' } }, y: { ticks: { color: '#aaa' } } } }
            });
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(revenueCtx, {
                type: 'doughnut',
                data: { labels: ['Quantum Slots', 'Blackjack', 'Roulette', 'Dice'], datasets: [{ data: [0,0,0,0], backgroundColor: ['#00D4FF','#6C2C9C','#FFD23F','#73BE28'], borderWidth: 0 }] },
                options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { color: '#fff', padding: 20 } } } }
            });
            updateMetricsDisplay();
            setInterval(updateMetrics, 5000);
        });
        function updateMetrics() {
            analyticsData.totalPlayers += Math.floor(Math.random()*3)-1;
            analyticsData.totalPlayers = Math.max(0, analyticsData.totalPlayers);
            analyticsData.totalBets += Math.floor(Math.random()*500);
            analyticsData.activeGames = Math.floor(Math.random()*10)+1;
            updateMetricsDisplay();
            updateCharts();
        }
        function updateMetricsDisplay() {
            document.getElementById('totalPlayers').textContent = analyticsData.totalPlayers || 0;
            document.getElementById('totalBets').textContent = `$${(analyticsData.totalBets||0).toLocaleString()}`;
            document.getElementById('houseEdge').textContent = `${analyticsData.houseEdge||5.2}%`;
            document.getElementById('activeGames').textContent = analyticsData.activeGames || 0;
        }
        function updateCharts() {
            const now = new Date().toLocaleTimeString();
            if (gameActivityChart.data.labels.length > 10) { gameActivityChart.data.labels.shift(); gameActivityChart.data.datasets[0].data.shift(); }
            gameActivityChart.data.labels.push(now);
            gameActivityChart.data.datasets[0].data.push(analyticsData.activeGames);
            gameActivityChart.update();
            revenueChart.data.datasets[0].data = [
                analyticsData.revenue?.slots || Math.floor(Math.random()*1000),
                analyticsData.revenue?.blackjack || Math.floor(Math.random()*800),
                analyticsData.revenue?.roulette || Math.floor(Math.random()*600),
                analyticsData.revenue?.dice || Math.floor(Math.random()*400)
            ];
            revenueChart.update();
        }
    </script>
</body>
</html>
